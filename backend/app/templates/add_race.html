<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Add Your Race — F1 Race Analytics</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;800&family=Montserrat:wght@700;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/static/css/listing.css"/>
  <link rel="stylesheet" href="/static/css/navbar.css"/>
  <link rel="stylesheet" href="/static/css/add_race.css"/>
</head>

<body>
  {% include "navbar.html" %}

  <div class="hero-banner">
    <div class="hero-content">
      <h1 class="hero-title">Add your race data</h1>
      <p class="hero-subtitle">
        Upload your simulation or custom race data. Add constructors, drivers, and race results.
      </p>
    </div>
  </div>

    <!-- ...existing code... -->
  <div class="content-wrapper">
    <div class="add-race-layout">
      <!-- LEFT: Sections -->
      <div class="left-column">
        <div class="add-race-container">
          <!-- Constructor Section -->
          <div class="section-card">
            <div class="section-header" onclick="toggleSection('constructor')">
              <div class="section-title-wrapper">
                <h3 class="section-title">Add Constructor</h3>
                <p class="section-subtitle">Team information</p>
              </div>
              <svg class="chevron" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9l6 6 6-6"></path>
              </svg>
            </div>

            <div class="section-content" id="constructor-section" style="display:none;">

              <!-- Mode toggle -->
              <div class="mode-toggle" role="tablist" aria-label="Constructor mode">
                <button type="button" class="mode-btn active" data-mode="custom"
                        onclick="setSectionMode('custom')" aria-selected="true">
                  Add custom constructor
                </button>
                <button type="button" class="mode-btn" data-mode="existing"
                        onclick="setSectionMode('existing')" aria-selected="false">
                  Select existing constructor
                </button>
              </div>

              <!-- Mode: custom (existing form) -->
              <div id="section-mode-custom">
                <form id="constructorForm">
                  <div class="form-grid">
                    <div class="form-group">
                      <label for="constructor_country">Country*</label>
                      <select id="constructor_country" name="constructor_country" required>
                        <option value="">Select a country</option>
                        {% for country in countries %}
                          <option value="{{ country.id }}">{{ country.name }}</option>
                        {% endfor %}
                      </select>
                    </div>
                    
                    <div class="form-group">
                      <label for="constructor_name">Name*</label>
                      <input type="text" id="constructor_name" name="constructor_name" required placeholder="e.g., My Racing Team"/>
                      <p class="input-hint">This will be used for both name and full name</p>
                    </div>
                    
                    <div class="form-group">
                      <label for="best_championship_position">Best Championship Position</label>
                      <input type="number" id="best_championship_position" name="best_championship_position" min="1" placeholder="e.g., 1"/>
                    </div>
                    
                    <div class="form-group">
                      <label for="total_championship_wins">Total Championship Wins*</label>
                      <input type="number" id="total_championship_wins" name="total_championship_wins" required min="0" value="0"/>
                    </div>
                    
                    <div class="form-group">
                      <label for="total_race_starts">Total Race Starts*</label>
                      <input type="number" id="total_race_starts" name="total_race_starts" required min="0" value="0"/>
                    </div>
                    
                    <div class="form-group">
                      <label for="total_podiums">Total Podiums*</label>
                      <input type="number" id="total_podiums" name="total_podiums" required min="0" value="0"/>
                    </div>
                    
                    <div class="form-group">
                      <label for="total_points">Total Points*</label>
                      <input type="number" step="0.01" id="total_points" name="total_points" required min="0" value="0"/>
                    </div>
                    
                    <div class="form-group">
                      <label for="total_pole_positions">Total Pole Positions*</label>
                      <input type="number" id="total_pole_positions" name="total_pole_positions" required min="0" value="0"/>
                    </div>
                  </div>
                  <button type="button" class="btn-primary" onclick="saveConstructor()">Save Constructor</button>
                </form>
              </div>

              <!-- Mode: existing -->
              <div id="section-mode-existing" style="display:none;">
                <div class="form-grid">
                  <div class="form-group" style="grid-column:1 / -1;">
                    <label for="sectionSearch">Find constructor</label>
                    <input type="text" id="sectionSearch" placeholder="Type to search constructors..."/>
                    <p class="input-hint">Start typing to search. Results load from the database.</p>
                  </div>
                  <div class="form-group" style="grid-column:1 / -1;">
                    <label for="existingSectionSelect">Results</label>
                    <select id="existingSectionSelect" size="6">
                      <!-- options will be populated by JS -->
                    </select>
                    <p class="input-hint">Select one and save.</p>
                  </div>
                </div>
                <button type="button" class="btn-primary" onclick="saveExistingSection()">Save Selected Constructor</button>
              </div>

            </div>
          </div>

          <!-- Driver Section -->
          <div class="section-card">
            <div class="section-header" onclick="toggleSection('driver')">
              <div class="section-title-wrapper">
                <h3 class="section-title">Add Driver</h3>
                <p class="section-subtitle">Driver information</p>
              </div>
              <svg class="chevron" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9l6 6 6-6"></path>
              </svg>
            </div>
            <div class="section-content" id="driver-section" style="display:none;">
              <!-- You can add driver fields here later -->
              <p class="input-hint">Driver form coming soon</p>
              <button type="button" class="btn-primary" onclick="saveDriver()">Save Driver</button>
            </div>
          </div>

          <!-- Race Section -->
          <div class="section-card">
            <div class="section-header" onclick="toggleSection('race')">
              <div class="section-title-wrapper">
                <h3 class="section-title">Add Race</h3>
                <p class="section-subtitle">Race information</p>
              </div>
              <svg class="chevron" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9l6 6 6-6"></path>
              </svg>
            </div>
            <div class="section-content" id="race-section" style="display:none;">

              <!-- Mode toggle -->
              <div class="mode-toggle" role="tablist" aria-label="Race mode">
                <button type="button" class="mode-btn active" data-mode="custom"
                        onclick="setRaceMode('custom')" aria-selected="true">
                  Add custom race
                </button>
                <button type="button" class="mode-btn" data-mode="existing"
                        onclick="setRaceMode('existing')" aria-selected="false">
                  Select existing race
                </button>
              </div>

              <!-- Mode: custom -->
              <div id="race-mode-custom">
                <form id="raceForm">
                  <div class="form-grid">
                    <div class="form-group">
                      <label for="race_circuit">Circuit*</label>
                      <select id="race_circuit" name="race_circuit" required>
                        <option value="">Select a circuit</option>
                        {% for circuit in circuits %}
                          <option value="{{ circuit.id }}">{{ circuit.name }} ({{ circuit.full_name }})</option>
                        {% endfor %}
                      </select>
                    </div>
                    
                    <div class="form-group">
                      <label for="race_official_name">Official Name*</label>
                      <input type="text" id="race_official_name" name="race_official_name" required placeholder="e.g., 2024 Monaco Grand Prix"/>
                    </div>
                    
                    <div class="form-group">
                      <label for="race_year">Year*</label>
                      <input type="number" id="race_year" name="race_year" required min="1950" placeholder="e.g., 2024"/>
                    </div>
                    
                    <div class="form-group">
                      <label for="race_round">Round*</label>
                      <input type="number" id="race_round" name="race_round" required min="1" placeholder="e.g., 1"/>
                    </div>
                    
                    <div class="form-group">
                      <label for="race_date">Race Date*</label>
                      <input type="date" id="race_date" name="race_date" required/>
                    </div>
                    
                    <div class="form-group">
                      <label for="race_qualifying_format">Qualifying Format*</label>
                      <select id="race_qualifying_format" name="race_qualifying_format" required>
                        <option value="">Select format</option>
                        <option value="KNOCKOUT">Knockout</option>
                        <option value="SPRINT_RACE">Sprint Race</option>
                        <option value="ONE_SESSION">One Session</option>
                        <option value="TWO_SESSION">Two Session</option>
                        <option value="FOUR_LAPS">Four Laps</option>
                        <option value="AGGREGATE">Aggregate</option>
                      </select>
                    </div>
                    
                    <div class="form-group">
                      <label for="race_laps">Laps*</label>
                      <input type="number" id="race_laps" name="race_laps" required min="1" placeholder="e.g., 78"/>
                    </div>
                    
                    <div class="form-group">
                      <label for="race_qualifying_date">Qualifying Date</label>
                      <input type="date" id="race_qualifying_date" name="race_qualifying_date"/>
                      <p class="input-hint">Optional</p>
                    </div>
                  </div>
                  <button type="button" class="btn-primary" onclick="saveRace()">Save Race</button>
                </form>
              </div>

              <!-- Mode: existing -->
              <div id="race-mode-existing" style="display:none;">
                <div class="form-grid">
                  <div class="form-group" style="grid-column:1 / -1;">
                    <label for="raceSearch">Find race</label>
                    <input type="text" id="raceSearch" placeholder="Type to search races by name..."/>
                    <p class="input-hint">Start typing to search. Results load from the database.</p>
                  </div>
                  <div class="form-group" style="grid-column:1 / -1;">
                    <label for="existingRaceSelect">Results</label>
                    <select id="existingRaceSelect" size="6">
                      <!-- options will be populated by JS -->
                    </select>
                    <p class="input-hint">Select one and save.</p>
                  </div>
                </div>
                <button type="button" class="btn-primary" onclick="saveExistingRace()">Save Selected Race</button>
              </div>

            </div>
          </div>

          <!-- Race Data Section -->
          <div class="section-card">
            <div class="section-header" onclick="toggleSection('racedata')">
              <div class="section-title-wrapper">
                <h3 class="section-title">Add Race Data</h3>
                <p class="section-subtitle">Race performance data</p>
              </div>
              <svg class="chevron" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M6 9l6 6 6-6"></path>
              </svg>
            </div>
            <div class="section-content" id="racedata-section" style="display:none;">
              <p class="input-hint">Race data form coming soon</p>
              <button type="button" class="btn-primary" onclick="saveRaceData()">Save Race Data</button>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT: Live Saved Summary -->
      <aside class="right-column">
        <div class="summary-card">
          <div class="summary-header">
            <h3 class="summary-title">Saved Summary</h3>
            <p class="summary-subtitle">What you’ve added so far</p>
          </div>
          <div class="summary-content" id="savedSummary">
            <!-- Filled by JS -->
            <div class="summary-empty">No data saved yet. Save a section to see it here.</div>
          </div>
        </div>

        <!-- General Submit Button -->
        <div class="submit-container">
        <button type="button" id="submitAllBtn" class="btn-submit add-race-btn" onclick="submitAllData()">
            Submit Data
        </button>
        <p class="input-hint">Make sure all required sections are filled before submitting</p>
        </div>
      </aside>
    </div>
  </div>

  <script src="/static/js/navbar.js"></script>
  <script src="/static/js/add_race.js"></script>
</body>
</html>